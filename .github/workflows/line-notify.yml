name: Notify LINE Group on GitHub Push

on:
  push:
    branches:
      - data-eda

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Format Message and Send to LINE Notify
        run: |
          BRANCH_NAME=$(echo ${{ github.ref }} | sed 's/refs\/heads\///')
          COMMIT_MESSAGE="${{ github.event.head_commit.message }}"
          COMMIT_HASH=$(echo ${{ github.sha }} | cut -c1-7)  # Shortened commit hash
          COMMIT_URL="https://github.com/${{ github.repository }}/commit/${{ github.sha }}"
          
          curl -X POST "https://notify-api.line.me/api/notify" \
          -H "Authorization: Bearer ${{ secrets.LINE_NOTIFY_TOKEN }}" \
          -F message="ğŸš€ *GitHub Update Notification*\n\nğŸ‘¤ *${{ github.actor }}* pushed to *${BRANCH_NAME}* in *${{ github.repository }}*\n\nğŸ“ *Commit Message:*\nâœ ${COMMIT_MESSAGE}\n\nğŸ”— [View Commit](${COMMIT_URL})"
