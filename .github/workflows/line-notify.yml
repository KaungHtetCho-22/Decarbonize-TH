name: Notify LINE Group on GitHub Push

on:
  push:
    branches:
      - data-eda 

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4  

      - name: Format Message and Send to LINE Notify
        run: |
          BRANCH_NAME=$(echo ${{ github.ref }} | sed 's/refs\/heads\///')
          COMMIT_MESSAGE=$(git log -1 --pretty=format:"%s%n%b")  # Get full commit message (title + body)
          COMMIT_HASH=$(echo ${{ github.sha }} | cut -c1-7)  # Shortened commit hash
          COMMIT_URL="https://github.com/${{ github.repository }}/commit/${{ github.sha }}"

          curl -X POST "https://notify-api.line.me/api/notify" \
          -H "Authorization: Bearer ${{ secrets.LINE_NOTIFY_TOKEN }}" \
          -F message="üöÄ *GitHub Update Notification*\n\nüë§ *${{ github.actor }}* pushed to *${BRANCH_NAME}* in *${{ github.repository }}*\n\nüìù *Commit Details:*\n‚ûú ${COMMIT_MESSAGE}\n\nüîó [View Commit](${COMMIT_URL})"
